<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>27번 도구 – 엑셀 업로드</title>

<style>
body { font-family: Arial; margin:0; padding:0; background:#ffffff; }
header { padding:10px; background:#f2f2f2; border-bottom:1px solid #ccc; }
button { padding:6px 12px; margin:4px; cursor:pointer; }
table { border-collapse: collapse; width:100%; }
th, td { border:1px solid #ccc; padding:4px; font-size:13px; }
th { background:#f7f7f7; }
.xbtn {
  background:#ff5555;
  color:white;
  border:none;
  font-weight:bold;
  width:28px;
  height:28px;
  font-size:16px;
}
#logBox {
  position:fixed;
  bottom:0;
  left:0;
  right:0;
  height:140px;
  overflow:auto;
  background:#ffffff;
  border-top:1px solid #ccc;
  font-size:12px;
  padding:6px;
}
</style>

<script>
/* ===== REPLACE HARD LOCK ===== */
const TOOL_ID = "tool27";
const REPLACE_KEY = "wic_replace_lock_" + TOOL_ID;
const REPLACE_MAX = 1;

(function(){
  let count = Number(localStorage.getItem(REPLACE_KEY) || 0);
  if (count >= REPLACE_MAX) {
    document.body.innerHTML = "<h2>MIN UI MODE</h2>";
    throw new Error("REPLACE LOCK");
  }
  localStorage.setItem(REPLACE_KEY, count + 1);
})();

/* ===== DB / LOG ===== */
const DB_KEY = "wic_xdb_v27";
const LOG_KEY = "wic_xlog_v27";

function log(msg){
  let logs = JSON.parse(localStorage.getItem(LOG_KEY) || "[]");
  let time = new Date().toISOString();
  logs.push(`[${time}] ${msg}`);
  localStorage.setItem(LOG_KEY, JSON.stringify(logs));
  renderLog();
}

function renderLog(){
  let logs = JSON.parse(localStorage.getItem(LOG_KEY) || "[]");
  document.getElementById("logBox").innerText = logs.join("\n");
}

function clearLog(){
  localStorage.removeItem(LOG_KEY);
  renderLog();
}

/* ===== TABLE ===== */
function makeRow(cols){
  let tr = document.createElement("tr");
  cols.forEach((c,i)=>{
    let td = document.createElement("td");
    td.innerText = c || "(빈값)";
    let x = document.createElement("button");
    x.className="xbtn";
    x.innerText="X";
    x.onclick=()=>log(`셀 X: col${i}`);
    td.appendChild(document.createElement("br"));
    td.appendChild(x);
    tr.appendChild(td);
  });
  return tr;
}

function addDummy(){
  const table = document.getElementById("tbl");
  table.appendChild(makeRow([
    "Publisher","Title","Sub","ISBN","Price"
  ]));
}

/* ===== INIT ===== */
window.onload=()=>{
  renderLog();
};
</script>
</head>

<body>

<header>
<button onclick="addDummy()">테스트 행 추가</button>
<button onclick="clearLog()">로그 초기화</button>
</header>

<table id="tbl">
<tr>
<th>Publisher</th>
<th>Title</th>
<th>Sub Title</th>
<th>ISBN</th>
<th>Price</th>
</tr>
</table>

<div id="logBox"></div>

</body>
</html>
